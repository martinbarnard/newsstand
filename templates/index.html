{% extends "layout.html" %}
{% block  title %}Index{% endblock %}
{% block head %}
    {{ super() }}
    {% endblock %}
{% block body %}
    {% set local_btn = "w3-btn w3-dark-grey w3-hover-khaki w3-round w3-tiny " %}
    {% set local_btn_style = "margin-left:4px;margin-top:4px;margin-bottom:4px;" %}
    {% if tokens != None %}
        <div class="w3-container w3-card w3-margin w3-pale-red">
            Keywords: 
            {% for t in tokens %}
                {% if tokens[t] > 3 %}
                <a style="{{local_btn_style}}" class="{{local_btn}}" href="?keyword={{t}}">{{t}}:<span class="w3-badge w3-margin-left w3-white">{{tokens[t]}}</span> </a>
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}
    {% set local_btn = "w3-btn w3-sand w3-hover-khaki w3-round w3-tiny " %}
    {% if sources != None %}
        <div class="w3-container w3-card w3-margin w3-pale-green">
            Sources: 
            {% for s  in sources %}
                <a style="{{local_btn_style}}" class="{{local_btn}}" href="?source={{s['id']}}">{{s['id'].replace('-', ' ').title()}}</a>
            {% endfor %}
        </div>
    {% endif %}
    {% set local_btn = "w3-btn w3-pale-red w3-hover-khaki w3-round w3-tiny " %}
    {% if categories != None %}
        <div class="w3-container w3-card w3-margin w3-pale-blue">
            Categories: 
            {% for row in categories %}
                    <a style="{{local_btn_style}}" class="{{local_btn}}" href="?category={{row}}">{{row}}</a>
            {% endfor %}
        </div>
    {% endif %}
    <div class="inputform" style="padding-top:8px;">
        <form action="news" method=post class="get-articles">
            Author: <span><input type=text size=30 name=author></span> <span>Keyword:</span><span><input type=text size=30 name=keyword></span>
            <input type=submit value=grab>
        </form>
    </div>

    {% if rows != None %}
        <div class="w3-container">
          {% for row in rows[1:] %}
           <div class="w3-third w3-card-4 w3-padding-large w3-section w3-sand ">
               <div class="w3-container">

                   <!-- Toprow -->
                   <div class="w3-row " style="margin-bottom:4px;">
                           <div class="w3-third " style="margin-bottom:4px;">
                            <a class="w3-round w3-hover-purple w3-left " alt="go to article" title="go see it" href="{{ row['url'] }}">
                              {% if row['urlToImage'] != None %}
                                  <img  src="{{ row['urlToImage']|safe }}" class="urlImg" height="55px" />
                              {% else %}
                                  <img  src="static/newzz.png" class="urlImg" height="55px" />
                              {% endif %}
                            </a>
                           </div>
                           <div class="w3-twothird">
                               <a class="{{local_btn}}" href='news?source={{row["src"]}}'>{{ row['src'] }}</a> 
                              {% if row['publishedAt'] != None %}
                                  {{ row['publishedAt'] }}
                              {% endif %}
                               {% if row['category'] != None %}
                               <a class="{{local_btn}}" href="news?category={{row['category']}}">{{ row['category']}}</a>
                               {% endif %}
                       </div>
                           </div>
                   </div>
                   <!-- 2nd row -->
                   <div class="w3-row" style="margin-bottom:4px;">
                       <div class="w3-third">
                           {% if row['author'] != None and row['author'] != '' %}
                               by {{ row['author'] }}
                           {% endif %}
                   </div>
                   <!-- 3rd row -->
                   <div class="w3-row">
                       {% set rid =  row['_id'] %}
                       <button onclick="accordian_m('acc_{{rid}}');" class="w3-btn-block w3-left-align"> {{row['title']}} ... </button>
                       <div class="w3-container w3-hide" id="acc_{{rid}}">
                          {{row['description']}}
                       </div>
                   </div>
                  {% if row['tokens'] %}
                      <div class="w3-panel w3-border w3-light-grey w3-round-large" style="margin-bottom:5px;">
                          {% for t in row['tokens'] %}
                            <a style="padding-top:2px; padding-bottom:2px;" class="w3-btn w3-tag w3-tiny w3-teal w3-tiny  w3-round" href="?keyword={{t}}">{{t}}</a>
                          {% endfor %}
                      </div>
                  {% endif %}
               </div>
           </div>
          {% endfor %}
        </div>


    {% endif %}
    <script>
    function accordian_m(id) {
        var x = document.getElementById(id);
        if (x.className.indexOf("w3-show") == -1) {
            x.className += " w3-show";
        } else {
            x.className = x.className.replace(" w3-show", "");
        }
    }
</script>
<style>
    img:hover {
        box-shadow: 2px 2px 4px grey;
    }
</style>
{% endblock %}
